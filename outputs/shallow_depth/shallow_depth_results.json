{
  "experiment": "shallow_depth",
  "description": "Testing if depths L=2-5 improve over L=6 at 20M scale",
  "fixed_params": {
    "learning_rate": 0.0001,
    "dropout": 0.5,
    "context_length": 80,
    "epochs": 50,
    "early_stopping_patience": 10,
    "threshold": 0.01
  },
  "reference": {
    "20M_L6_auc": 0.7342,
    "rf_target_auc": 0.716
  },
  "architectures": {
    "20M_L2": {
      "d_model": 896,
      "n_layers": 2,
      "n_heads": 8,
      "d_ff": 3584
    },
    "20M_L3": {
      "d_model": 720,
      "n_layers": 3,
      "n_heads": 8,
      "d_ff": 2880
    },
    "20M_L4": {
      "d_model": 640,
      "n_layers": 4,
      "n_heads": 8,
      "d_ff": 2560
    },
    "20M_L5": {
      "d_model": 560,
      "n_layers": 5,
      "n_heads": 8,
      "d_ff": 2240
    }
  },
  "results": [
    {
      "config_name": "20M_L2",
      "d_model": 896,
      "n_layers": 2,
      "n_heads": 8,
      "d_ff": 3584,
      "n_params": 19677057,
      "learning_rate": 0.0001,
      "dropout": 0.5,
      "micro_batch": 16,
      "accumulation_steps": 16,
      "train_samples": 7257,
      "val_samples": 422,
      "best_val_auc": 0.7163281585567896,
      "final_val_auc": 0.6982880284714978,
      "best_epoch": 30,
      "total_epochs": 40,
      "pred_min": 0.03474585711956024,
      "pred_max": 0.2823047637939453,
      "pred_std": 0.05246962234377861,
      "training_time_min": 1.5888329823811849,
      "history": {
        "train_loss": [
          0.07524144258191112,
          0.04512653965605546,
          0.0425463711580319,
          0.04239859562449256,
          0.042036477427125504,
          0.041341062651594304,
          0.04092849979776118,
          0.04105034552100176,
          0.041633154013776735,
          0.04029101819735398,
          0.040054952115485126,
          0.0402688766318878,
          0.04010370176076265,
          0.03979764941624378,
          0.0397387274586091,
          0.0400236814235653,
          0.03922766410963126,
          0.03957210391316776,
          0.03939107658099465,
          0.040254348557696794,
          0.03875181993412158,
          0.03918921437200635,
          0.03888166215504614,
          0.03880980300577563,
          0.03815908540893625,
          0.039151986244458724,
          0.03918168799016247,
          0.03876287316583458,
          0.037849760120980736,
          0.03816848122699408,
          0.03746983107171198,
          0.03802439385136827,
          0.03886956352194861,
          0.03761213646569835,
          0.03753262541014783,
          0.0378259738819009,
          0.03701848838589101,
          0.03727835210836144,
          0.03715454489259369,
          0.03644388756357823
        ],
        "val_loss": [
          0.07659067523336152,
          0.043801640345783974,
          0.04445264313027211,
          0.047763471821478255,
          0.04674555820841946,
          0.05104702937468472,
          0.05182938911538157,
          0.06759427624200287,
          0.04643028371652623,
          0.040991678111755324,
          0.04664727858983463,
          0.033722573912840476,
          0.04371677147530675,
          0.03713065857947287,
          0.03195104544499406,
          0.040492108447425484,
          0.037300470658077824,
          0.034318009007687646,
          0.032285307396065305,
          0.038573055890285306,
          0.04718094954107612,
          0.04028351734935617,
          0.04401343908264405,
          0.03470035827787662,
          0.03304380475095025,
          0.03337339608481637,
          0.03390583877141277,
          0.03508625857325064,
          0.032772837543032236,
          0.03317488849387263,
          0.03907176146404473,
          0.030951828626846825,
          0.03203261285347657,
          0.03816447482246009,
          0.04423015377337665,
          0.03113462448258091,
          0.04163020830364311,
          0.03510569946525653,
          0.033419912620620044,
          0.03881023528002617
        ],
        "val_auc": [
          0.6389519543474259,
          0.6650303736884089,
          0.6752162974780634,
          0.6757071853715407,
          0.6674848131557956,
          0.6576056942995644,
          0.6666871203288949,
          0.68319322574707,
          0.6799410934527828,
          0.6392587592808492,
          0.6468675216297478,
          0.6972448916978584,
          0.6836227526538626,
          0.6990857212983985,
          0.6821500889734307,
          0.6849113333742406,
          0.691108793029392,
          0.6820273670000613,
          0.6584647481131497,
          0.6574829723261949,
          0.6725164140639381,
          0.6660121494753637,
          0.7011719948456772,
          0.6751549364913788,
          0.6954654230840033,
          0.6739277167576854,
          0.6809842302264221,
          0.6838681966006013,
          0.7112351966619622,
          0.7163281585567896,
          0.6944836472970486,
          0.6911087930293918,
          0.6828864208136467,
          0.6946677302571026,
          0.678222985825612,
          0.7027673804994785,
          0.6922132907897158,
          0.7127692213290789,
          0.6979812235380745,
          0.6982880284714978
        ]
      }
    },
    {
      "config_name": "20M_L3",
      "d_model": 720,
      "n_layers": 3,
      "n_heads": 8,
      "d_ff": 2880,
      "n_params": 19000801,
      "learning_rate": 0.0001,
      "dropout": 0.5,
      "micro_batch": 16,
      "accumulation_steps": 16,
      "train_samples": 7257,
      "val_samples": 422,
      "best_val_auc": 0.713873719089403,
      "final_val_auc": 0.6964471988709579,
      "best_epoch": 27,
      "total_epochs": 37,
      "pred_min": 0.09678297489881516,
      "pred_max": 0.3545607328414917,
      "pred_std": 0.051109302788972855,
      "training_time_min": 1.7476052363713583,
      "history": {
        "train_loss": [
          0.09604418599083261,
          0.04600689651255828,
          0.043548547050460254,
          0.04207577015835349,
          0.04172685167789131,
          0.04218212518295363,
          0.0418628055308966,
          0.04045977863680063,
          0.04090894998096356,
          0.04001378146562282,
          0.039639964353063425,
          0.04023762656753218,
          0.03989228704074472,
          0.039618937762265424,
          0.0388534571513911,
          0.03928737560315837,
          0.039203664226383626,
          0.038560420154729276,
          0.039740913811176684,
          0.03841646438021426,
          0.03906416249900466,
          0.03927146008500772,
          0.039453026601667246,
          0.038963692276102656,
          0.03800482803028454,
          0.038751712427905344,
          0.03747053129910307,
          0.038367490902633326,
          0.03723296333957742,
          0.03722307905000901,
          0.03844385007334799,
          0.04027089959273057,
          0.03788184857053378,
          0.037109803225812275,
          0.03722401438711728,
          0.03711512947602747,
          0.03777676251499466
        ],
        "val_loss": [
          0.04811338404235559,
          0.045191462840496875,
          0.058701206328098325,
          0.052965115533744986,
          0.05933077000803745,
          0.03634506495048603,
          0.041711509169545025,
          0.05643009659535084,
          0.05465979684797478,
          0.041529759057556036,
          0.05321542096849212,
          0.03555970680382517,
          0.0406638577847776,
          0.04097252727822504,
          0.040467663021344275,
          0.032361721283652715,
          0.034206223079106875,
          0.04550662208283837,
          0.03797565855913692,
          0.044944073390474334,
          0.03951926108372087,
          0.038804373567001206,
          0.030867052661186015,
          0.03519212142607473,
          0.04006623223216997,
          0.037157067697046804,
          0.04038664255036834,
          0.03588697211860024,
          0.037666594857539704,
          0.030540340614539606,
          0.031101211595038574,
          0.03979495806076253,
          0.03221830889082479,
          0.03779650739333765,
          0.03295566704710601,
          0.03744870639207808,
          0.03099392658030545
        ],
        "val_auc": [
          0.5748297232619501,
          0.6567466404859791,
          0.6915996809228693,
          0.6695710867030742,
          0.6886543535620052,
          0.6827636988402772,
          0.6910474320427074,
          0.6956495060440572,
          0.6959563109774805,
          0.682456893906854,
          0.6968153647910659,
          0.6663803153954715,
          0.7016015217524697,
          0.7019696876725777,
          0.6987175553782904,
          0.6967540038043812,
          0.7100693379149537,
          0.699331165245137,
          0.713505553169295,
          0.7070012885807204,
          0.7025219365527398,
          0.7078603423943057,
          0.7034423513530097,
          0.6927041786831933,
          0.7027060195127938,
          0.6942382033503098,
          0.713873719089403,
          0.7032582683929558,
          0.7015401607657852,
          0.6969994477511199,
          0.7074921764741977,
          0.6902497392158066,
          0.6976744186046512,
          0.6934405105234092,
          0.6888384365220592,
          0.6946677302571025,
          0.6964471988709579
        ]
      }
    },
    {
      "config_name": "20M_L4",
      "d_model": 640,
      "n_layers": 4,
      "n_heads": 8,
      "d_ff": 2560,
      "n_params": 19969921,
      "learning_rate": 0.0001,
      "dropout": 0.5,
      "micro_batch": 16,
      "accumulation_steps": 16,
      "train_samples": 7257,
      "val_samples": 422,
      "best_val_auc": 0.7176781002638523,
      "final_val_auc": 0.7112351966619623,
      "best_epoch": 23,
      "total_epochs": 33,
      "pred_min": 0.09773731976747513,
      "pred_max": 0.29875436425209045,
      "pred_std": 0.04164358973503113,
      "training_time_min": 1.7170209487279255,
      "history": {
        "train_loss": [
          0.09612746348655665,
          0.04500834812873786,
          0.04255396144932325,
          0.0418702868082138,
          0.041030394592392154,
          0.04174842213440506,
          0.0407749494078204,
          0.04029113560348815,
          0.04129783280751779,
          0.04066300124857197,
          0.0402373772438632,
          0.04047477489649134,
          0.03967213088703969,
          0.039295191394517995,
          0.0397003929075346,
          0.03986072593208583,
          0.038543607576007624,
          0.03913823313321836,
          0.03905402942938065,
          0.03880980253703728,
          0.037900120639426854,
          0.03832277739297451,
          0.03818640496483327,
          0.037994262986992884,
          0.037845849936483385,
          0.037623703493100756,
          0.037521645575474605,
          0.03727079264405245,
          0.03743380256456688,
          0.03723857521145125,
          0.03762465172000065,
          0.037135160587613146,
          0.03714529701533198
        ],
        "val_loss": [
          0.04026367929246691,
          0.04738637070167223,
          0.036611007405789917,
          0.054026335339855264,
          0.03908570733619854,
          0.04381641299308588,
          0.04135589348799032,
          0.042145384848548996,
          0.037532232992816716,
          0.051083006506949594,
          0.03560837647981114,
          0.035777332882086434,
          0.03392407757281843,
          0.031144972274045425,
          0.04553516210742398,
          0.03160045258873315,
          0.03678372138852461,
          0.033786052001502226,
          0.04269255004301495,
          0.033661388576513636,
          0.03035811639252912,
          0.04396710741976104,
          0.03028196133500724,
          0.031257445475569474,
          0.031086410714865283,
          0.030628123682820134,
          0.03236077772453427,
          0.03025213246992617,
          0.029945596724886586,
          0.031069505821775506,
          0.03305545102166771,
          0.03040501583126132,
          0.03179858958659073
        ],
        "val_auc": [
          0.5703503712339695,
          0.6423268086150825,
          0.6531877032582684,
          0.6872430508682579,
          0.6872430508682579,
          0.6914769589494999,
          0.7124624163956556,
          0.680247898386206,
          0.713321470209241,
          0.6976130576179664,
          0.6834386696938087,
          0.7016628827391544,
          0.6938086764435172,
          0.7010492728723078,
          0.7154691047432044,
          0.708351230287783,
          0.7021537706326317,
          0.6960790329508498,
          0.7040559612198565,
          0.6947904522304719,
          0.6992698042584524,
          0.709639811008161,
          0.7176781002638523,
          0.7139350800760876,
          0.7079217033809903,
          0.710744308768485,
          0.7154691047432042,
          0.7027673804994784,
          0.7168190464502668,
          0.7115420015953857,
          0.7066331226606123,
          0.7050990979934957,
          0.7112351966619623
        ]
      }
    },
    {
      "config_name": "20M_L5",
      "d_model": 560,
      "n_layers": 5,
      "n_heads": 8,
      "d_ff": 2240,
      "n_params": 19093761,
      "learning_rate": 0.0001,
      "dropout": 0.5,
      "micro_batch": 16,
      "accumulation_steps": 16,
      "train_samples": 7257,
      "val_samples": 422,
      "best_val_auc": 0.7222188132785176,
      "final_val_auc": 0.7191507639442842,
      "best_epoch": 49,
      "total_epochs": 50,
      "pred_min": 0.08963312953710556,
      "pred_max": 0.36705464124679565,
      "pred_std": 0.06147896498441696,
      "training_time_min": 2.9976155678431193,
      "history": {
        "train_loss": [
          0.09238019796030851,
          0.045328949662212625,
          0.043330849319622576,
          0.041879093303193345,
          0.04268116798018011,
          0.04036981887122542,
          0.04053804167907373,
          0.04042056417051654,
          0.039510871855016914,
          0.04014262739499202,
          0.040189659899913,
          0.03947251293570263,
          0.039241970701364697,
          0.04059285866527404,
          0.03877832051079376,
          0.03843708972688682,
          0.038256247067364496,
          0.03829012410243407,
          0.03801942874455931,
          0.037739996561403116,
          0.03793193408727055,
          0.038363584698822006,
          0.03786054796063329,
          0.03780034510316204,
          0.03753238376783872,
          0.03781859301715794,
          0.0381472364538821,
          0.03787179324890811,
          0.03706446617415035,
          0.03703018051412137,
          0.037313127370206596,
          0.03731228598898137,
          0.03774581833882052,
          0.03810881510159485,
          0.03750616077965511,
          0.0369729545205372,
          0.0369652771957153,
          0.036986315894732454,
          0.0369355434137458,
          0.03659149197582566,
          0.03660207058996422,
          0.03662983508522126,
          0.03681847262750113,
          0.03635906921556047,
          0.03662114838109504,
          0.03639987526699441,
          0.036294288479924074,
          0.0362257633998268,
          0.036273578050575066,
          0.036543349150798
        ],
        "val_loss": [
          0.03954641530247129,
          0.04810780184063198,
          0.04490087030852145,
          0.05751594197095579,
          0.03647168380794702,
          0.037207196501118166,
          0.036332018410407556,
          0.04092159267316607,
          0.05328092129504377,
          0.034425209216014656,
          0.031026875531231915,
          0.03489227922357343,
          0.030866756276400002,
          0.0338948714564106,
          0.033686382213124526,
          0.03180413721646699,
          0.03055417870550796,
          0.03419689668549432,
          0.03012895480626159,
          0.030634500784799457,
          0.030295429302862397,
          0.03488166101656302,
          0.03049785059152378,
          0.03297103072206179,
          0.031718205082816656,
          0.04028146134698073,
          0.03053765378340527,
          0.030908673337695224,
          0.029962844715488178,
          0.030015855217007576,
          0.0301279680872405,
          0.030549769513998872,
          0.029898969163359317,
          0.030298671564432205,
          0.030396500774831685,
          0.03133049361511237,
          0.029869650352608274,
          0.029747734191241087,
          0.03028281258971051,
          0.02979877218604088,
          0.0301965501556104,
          0.029669966496941116,
          0.029691480772776738,
          0.029688399474791908,
          0.030263466743269452,
          0.030707135943144007,
          0.030114607290468283,
          0.03198825871502912,
          0.030258481778825324,
          0.031112834931937634
        ],
        "val_auc": [
          0.5737252255016261,
          0.6241639565564214,
          0.6514082346444131,
          0.6661962324354176,
          0.6709823893968215,
          0.6754617414248021,
          0.6808001472663681,
          0.6919678468429773,
          0.6882248266552127,
          0.67859115174572,
          0.6808615082530527,
          0.6883475486285819,
          0.6861385531079339,
          0.6873657728416274,
          0.6932564275633553,
          0.6865067190280421,
          0.6865680800147267,
          0.6950972571638951,
          0.6965699208443272,
          0.6988402773516598,
          0.6927655396698779,
          0.7049763760201264,
          0.6958949499907958,
          0.7024605755660552,
          0.6997606921519297,
          0.7006811069521998,
          0.7036877952997483,
          0.7055286249002883,
          0.7069399275940357,
          0.7066944836472971,
          0.7040559612198565,
          0.708167147327729,
          0.7076762594342517,
          0.7076148984475671,
          0.7113579186353316,
          0.7092716450880531,
          0.7109283917285389,
          0.7146100509296189,
          0.7163895195434743,
          0.7115420015953857,
          0.7159599926366815,
          0.7189666809842302,
          0.720868871571455,
          0.7185371540774376,
          0.7158372706633122,
          0.7160213536233663,
          0.7203779836779776,
          0.7113579186353316,
          0.7222188132785176,
          0.7191507639442842
        ]
      }
    }
  ],
  "timestamp": "2026-01-21T07:49:42.816727"
}